# elbo_gaa
Supporting code for the paper "Analytical Approximation of the ELBO Gradient in the Context of the Clutter Problem". The code is used to generate all figures in the paper and run the comparative tests.

[ResearchGate page](https://www.researchgate.net/publication/379823643_Analytical_Approximation_of_the_ELBO_Gradient_in_the_Context_of_the_Clutter_Problem), [arXiv page](https://arxiv.org/abs/2404.10550).

## Abstract
We propose an analytical solution for approximating the gradient of the Evidence Lower Bound (ELBO) in variational inference problems where the statistical model is a Bayesian network consisting of observations drawn from a mixture of a Gaussian distribution embedded in unrelated clutter, known as the clutter problem. The method employs the reparameterization trick to move the gradient operator inside the expectation and relies on the assumption that, because the likelihood factorizes over the observed data, the variational distribution is generally more compactly supported than the Gaussian distribution in the likelihood factors. This allows efficient local approximation of the individual likelihood factors, which leads to an analytical solution for the integral defining the gradient expectation. We integrate the proposed gradient approximation as the expectation step in an EM (Expectation Maximization) algorithm for maximizing ELBO and test against classical deterministic approaches in Bayesian inference, such as the Laplace approximation, Expectation Propagation and Mean-Field Variational Inference. The proposed method demonstrates good accuracy and rate of convergence together with linear computational complexity.
## Code Organization
The code environment is GNU Octave but it would also run in Matlab subject to minor compatibility issues with regards to displaying figures. Each figure is generated by a corresponding gen_figx.m file that needs to be run inside Octave or Matlab to generate the figure. Employment of the LaTex interpreter for the text in the figures has been disabled to avoid compatibility issues but the option for using LaTex has been left inside the code as commented sections. The code consists of the following files:
 - gen_fig1.m - generates figure 1
 - gen_fig2.m - generates figure 2
 - gen_fig3.m - generates figure 3
 - gen_fig4.m - generates figure 4
 - gen_fig5.m - generates figure 5
 - elbo_numerical.m - a function that numerically calculates the value of ELBO
 - elbo_numerical_em.m - implements a numerical maximisation of ELBO as a function
 - laplace.m - implements the Laplace approximation as a function
 - laplace_serial.m - implements the Laplace approximation as a function with serial code
 - ep_serial.m - implements expectation propagation as a function
 - elbo_mean_field.m - implements the mean field approximation as a function
 - elbo_mean_field_serial.m - implements the mean field approximation as a function with serial code
 - elbo_gaa_em.m - implements the proposed algorithm as a function
 - elbo_gaa_em_serial.m - implements the proposed algorithm as a function with serial code
 - get_rand_u0.m - stores pre-generated random numbers for reproducibility of test results from gen_fig5.m

The code is meant primarily for research purposes and has not been optimised or tested for numerical stability.
Use it with caution!


